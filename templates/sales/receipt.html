<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Receipt - SibLore POS</title>
    <meta name="robots" content="noindex,nofollow">
    <meta name="referrer" content="no-referrer">
    <meta name="google" content="notranslate">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap');
        
        @page {
            size: 80mm 200mm;
            margin: 5mm;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 11px;
            line-height: 1.4;
            margin: 0;
            padding: 16px;
            width: 100%;
            max-width: 280px;
            background: #ffffff;
            color: #1f2937;
        }
        
        /* Header Section */
        .receipt-header {
            text-align: center;
            margin-bottom: 24px;
            position: relative;
        }
        
        .brand-logo {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 12px;
            font-weight: 700;
            font-size: 20px;
            color: white;
            letter-spacing: -0.5px;
        }
        
        .brand-name {
            font-size: 18px;
            font-weight: 700;
            color: #111827;
            margin: 0 0 4px 0;
            letter-spacing: -0.3px;
        }
        
        .brand-tagline {
            font-size: 10px;
            color: #6b7280;
            margin: 0 0 12px 0;
            font-weight: 500;
        }
        
        .contact-info {
            font-size: 9px;
            color: #6b7280;
            line-height: 1.3;
        }
        
        .contact-info div {
            margin: 2px 0;
        }
        
        /* Dividers */
        .divider {
            height: 1px;
            background: linear-gradient(to right, transparent, #e5e7eb, transparent);
            margin: 20px 0;
            position: relative;
        }
        
        .divider-thick {
            height: 2px;
            background: linear-gradient(to right, #3b82f6, #1d4ed8);
            margin: 24px 0;
            border-radius: 1px;
        }
        
        /* Transaction Info */
        .transaction-info {
            background: #f9fafb;
            border-radius: 8px;
            padding: 12px;
            margin: 16px 0;
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 6px 0;
            font-size: 10px;
        }
        
        .info-label {
            color: #6b7280;
            font-weight: 500;
        }
        
        .info-value {
            color: #111827;
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .invoice-number {
            font-size: 12px;
            font-weight: 700;
            color: #3b82f6;
        }
        
        /* Items Table */
        .items-section {
            margin: 20px 0;
        }
        
        .section-title {
            font-size: 11px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .items-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 0;
        }
        
        .items-table th {
            text-align: left;
            padding: 8px 4px;
            font-size: 9px;
            font-weight: 600;
            color: #6b7280;
            border-bottom: 2px solid #e5e7eb;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }
        
        .items-table td {
            padding: 8px 4px;
            font-size: 10px;
            border-bottom: 1px solid #f3f4f6;
            vertical-align: top;
        }
        
        .items-table tbody tr:last-child td {
            border-bottom: none;
        }
        
        .item-name {
            font-weight: 500;
            color: #111827;
            line-height: 1.3;
            word-wrap: break-word;
            max-width: 120px;
        }
        
        .item-qty {
            text-align: center;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 500;
        }
        
        .item-price, .item-total {
            text-align: right;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 500;
        }
        
        /* Totals Section */
        .totals-section {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 8px;
            padding: 16px;
            margin: 20px 0;
            border: 1px solid #e2e8f0;
        }
        
        .total-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 8px 0;
            font-size: 10px;
        }
        
        .total-row.grand-total {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 2px solid #3b82f6;
        }
        
        .total-label {
            font-weight: 500;
            color: #374151;
        }
        
        .total-value {
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .grand-total .total-label {
            font-size: 12px;
            font-weight: 700;
            color: #111827;
        }
        
        .grand-total .total-value {
            font-size: 14px;
            font-weight: 700;
            color: #3b82f6;
        }
        
        .discount-row {
            color: #dc2626;
        }
        
        .balance-row {
            color: #f59e0b;
        }
        
        /* Payment Method Badge */
        .payment-badge {
            display: inline-block;
            padding: 4px 8px;
            background: #3b82f6;
            color: white;
            border-radius: 4px;
            font-size: 9px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }
        
        .payment-badge.CASH {
            background: #10b981;
        }
        
        .payment-badge.CARD {
            background: #8b5cf6;
        }
        
        .payment-badge.MOBILE {
            background: #f59e0b;
        }
        
        .payment-badge.DEBT {
            background: #ef4444;
        }
        
        /* Footer Section */
        .receipt-footer {
            text-align: center;
            margin-top: 24px;
            padding-top: 16px;
            border-top: 1px solid #e5e7eb;
        }
        
        .thank-you {
            font-size: 12px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 4px;
        }
        
        .come-again {
            font-size: 10px;
            color: #6b7280;
            margin-bottom: 12px;
        }
        
        .notes {
            font-size: 9px;
            color: #6b7280;
            font-style: italic;
            margin-top: 8px;
            padding: 8px;
            background: #f9fafb;
            border-radius: 6px;
            border-left: 3px solid #3b82f6;
        }
        
        .qr-code {
            width: 64px;
            height: 64px;
            background: #f3f4f6;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            margin: 12px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            color: #6b7280;
        }
        
        /* Print Optimization */
        @media print {
            @page {
                size: 80mm 200mm;
                margin: 3mm;
            }
            
            body {
                margin: 0;
                padding: 8px;
                font-size: 10px;
            }
            
            .receipt-header {
                margin-bottom: 16px;
            }
            
            .brand-logo {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            .brand-name {
                font-size: 16px;
            }
            
            .divider {
                margin: 12px 0;
            }
            
            .divider-thick {
                margin: 16px 0;
            }
            
            .transaction-info {
                padding: 8px;
                margin: 12px 0;
            }
            
            .totals-section {
                padding: 12px;
                margin: 16px 0;
            }
            
            .receipt-footer {
                margin-top: 16px;
                padding-top: 12px;
            }
            
            /* Hide browser headers and footers */
            @page :header {
                display: none;
            }
            
            @page :footer {
                display: none;
            }
            
            /* Ensure colors print well */
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
        }
        
        /* Utility Classes */
        .text-xs { font-size: 8px; }
        .text-sm { font-size: 9px; }
        .text-base { font-size: 10px; }
        .text-lg { font-size: 12px; }
        .text-xl { font-size: 14px; }
        
        .font-light { font-weight: 300; }
        .font-normal { font-weight: 400; }
        .font-medium { font-weight: 500; }
        .font-semibold { font-weight: 600; }
        .font-bold { font-weight: 700; }
        
        .text-gray-400 { color: #9ca3af; }
        .text-gray-500 { color: #6b7280; }
        .text-gray-600 { color: #4b5563; }
        .text-gray-700 { color: #374151; }
        .text-gray-800 { color: #1f2937; }
        .text-gray-900 { color: #111827; }
        
        .text-blue-600 { color: #3b82f6; }
        .text-green-600 { color: #10b981; }
        .text-red-600 { color: #dc2626; }
        .text-yellow-600 { color: #f59e0b; }
    </style>
</head>
<body>
    <!-- Header Section -->
    <div class="receipt-header">
        <div class="brand-logo">{{ business.name|slice:":2"|upper }}</div>
        <h1 class="brand-name">{{ business.name }}</h1>
        <p class="brand-tagline">Point of Sale System</p>
        <div class="contact-info">
            <div>{{ business.address }}, {{ business.city }}</div>
            <div>Tel: {{ business.phone }}</div>
            <div>Email: {{ business.email }}</div>
        </div>
    </div>
    
    <div class="divider-thick"></div>
    
    <!-- Transaction Information -->
    <div class="transaction-info">
        <div class="info-row">
            <span class="info-label">Invoice #:</span>
            <span class="info-value invoice-number">{{ sale.invoice_number }}</span>
        </div>
        <div class="info-row">
            <span class="info-label">Date & Time:</span>
            <span class="info-value">{{ sale.created_at|date:"M d, Y H:i" }}</span>
        </div>
        <div class="info-row">
            <span class="info-label">Cashier:</span>
            <span class="info-value">{{ sale.created_by|default:"System" }}</span>
        </div>
        {% if sale.customer %}
        <div class="info-row">
            <span class="info-label">Customer:</span>
            <span class="info-value">{{ sale.customer.name }}</span>
        </div>
        {% endif %}
        <div class="info-row">
            <span class="info-label">Payment:</span>
            <span class="payment-badge {{ sale.payment_method }}">{{ sale.get_payment_method_display }}</span>
        </div>
    </div>
    
    <!-- Items Section -->
    <div class="items-section">
        <h3 class="section-title">Order Details</h3>
        <table class="items-table">
            <thead>
                <tr>
                    <th class="item-name">Item</th>
                    <th class="item-qty">Qty</th>
                    <th class="item-price">Price</th>
                    <th class="item-total">Total</th>
                </tr>
            </thead>
            <tbody>
                {% for item in sale.sale_items.all %}
                <tr>
                    <td class="item-name">{{ item.product.name }}</td>
                    <td class="item-qty">{{ item.quantity }}</td>
                    <td class="item-price">{{ item.unit_price|floatformat:2 }}</td>
                    <td class="item-total">{{ item.total_price|floatformat:2 }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <!-- Totals Section -->
    <div class="totals-section">
        <div class="total-row">
            <span class="total-label">Subtotal:</span>
            <span class="total-value">{{ sale.subtotal|floatformat:2 }}</span>
        </div>
        <div class="total-row">
            <span class="total-label">Tax:</span>
            <span class="total-value">{{ sale.tax_amount|floatformat:2 }}</span>
        </div>
        {% if sale.discount_amount > 0 %}
        <div class="total-row discount-row">
            <span class="total-label">Discount:</span>
            <span class="total-value">-{{ sale.discount_amount|floatformat:2 }}</span>
        </div>
        {% endif %}
        <div class="total-row grand-total">
            <span class="total-label">TOTAL:</span>
            <span class="total-value">{{ sale.total_amount|floatformat:2 }}</span>
        </div>
        <div class="total-row">
            <span class="total-label">Amount Paid:</span>
            <span class="total-value">{{ sale.amount_paid|floatformat:2 }}</span>
        </div>
        {% if sale.change_amount > 0 %}
        <div class="total-row">
            <span class="total-label">Change:</span>
            <span class="total-value">{{ sale.change_amount|floatformat:2 }}</span>
        </div>
        {% endif %}
        {% if sale.balance_due > 0 %}
        <div class="total-row balance-row">
            <span class="total-label">Balance Due:</span>
            <span class="total-value">{{ sale.balance_due|floatformat:2 }}</span>
        </div>
        {% endif %}
    </div>
    
    <!-- Footer Section -->
    <div class="receipt-footer">
        <div class="thank-you">Thank you for your business!</div>
        <div class="come-again">We appreciate your visit</div>
        
        <!-- <div class="qr-code">
            QR Code
        </div>
        
        {% if sale.notes %}
        <div class="notes">
            <strong>Notes:</strong> {{ sale.notes }}
        </div>
        {% endif %}
        
        <div class="text-xs text-gray-500" style="margin-top: 12px;">
            Powered by {{ business.name }}
        </div> -->
    </div>
    
    <script>
        // Auto-print when page loads
        window.onload = function() {
            // Clear title to reduce header content
            document.title = 'Sales Receipt';
            
            setTimeout(function() {
                window.print();
                // Close window after a delay to allow print dialog
                setTimeout(function() {
                    window.close();
                }, 1000);
            }, 300);
        };
        
        // Handle print events
        window.addEventListener('beforeprint', function() {
            document.title = '';
        });
        
        window.addEventListener('afterprint', function() {
            window.close();
        });
    </script>
</body>
</html>
